FROM registry.redhat.io/openshift3/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogJzEuMC4wJwpuYW1lOiBueHAtbmV4dXMtYXBiCmRlc2NyaXB0aW9uOiBUaGlzIEFQ\
QiBkZXBsb3lzIE5leHVzIGFjY29yZGluZyB0byBOWFAgc3RhbmRhcmRzIGFuZCBkZWZhdWx0IGNv\
bmZpZ3VyYXRpb25zLgpiaW5kYWJsZTogRmFsc2UKYXN5bmM6IG9wdGlvbmFsIAptZXRhZGF0YToK\
ICBkb2N1bWVudGF0aW9uVXJsOiA8bGlua190b19kb2N1bWVudGF0aW9uPgogIGltYWdlVXJsOiBo\
dHRwczovL254cC5jb20vYXNzZXRzL2ltYWdlcy9lbi9sb2dvcy1pbnRlcm5hbC9OWFBfbG9nby5w\
bmcKICBkZXBlbmRlbmNpZXM6IFsncmVnaXN0cnkuY29ubmVjdC5yZWRoYXQuY29tL3NvbmF0eXBl\
L25leHVzLXJlcG9zaXRvcnktbWFuYWdlciddCiAgZGlzcGxheU5hbWU6IE5YUCBOZXh1cyBFbnZp\
cm9ubWVudCAKICBsb25nRGVzY3JpcHRpb246IFRoaXMgd2lsbCBpbnN0YWxsIGFuIE5YUCBOZXh1\
cyBzdXBwb3J0ZWQgZGVwbG95bWVudCBhY2NvcmRpbmcgdG8gTlhQIHN0YW5kYXJkIGNvbmZpZ3Vy\
YXRpb24gYW5kIHZlcnNpb25zLiBQbGVhc2UgcmVmZXIgdG8gaXRAbnhwIGZvciBhbnkgaW5mb3Jt\
YXRpb24KICBwcm92aWRlckRpc3BsYXlOYW1lOiAiUmVkIEhhdCBDb25zdWx0aW5nIgpwbGFuczoK\
ICAtIG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBBIHNob3J0IGRlc2NyaXB0aW9uIG9m\
IHdoYXQgdGhpcyBwbGFuIGRvZXMKICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOgogICAgICBk\
aXNwbGF5TmFtZTogRGVmYXVsdAogICAgICBsb25nRGVzY3JpcHRpb246IEEgbG9uZ2VyIGRlc2Ny\
aXB0aW9uIG9mIHdoYXQgdGhpcyBwbGFuIGRlcGxveXMKICAgICAgY29zdDogJDAuMDAKICAgIHBh\
cmFtZXRlcnM6CiAgICAgIC0gbmFtZTogbmV4dXNfc2VydmljZV9hY2NvdW50CiAgICAgICAgcmVx\
dWlyZWQ6IHRydWUKICAgICAgICBkZWZhdWx0OiBuZXh1cwogICAgICAgIHR5cGU6IHN0cmluZwog\
ICAgICAgIHRpdGxlOiBOZXh1cyBTZXJ2aWNlIEFjY291bnQKICAgICAgICBkaXNwbGF5X2dyb3Vw\
OiBwcm9qZWN0CiAgICAgIC0gbmFtZTogbmV4dXNfdm9sdW1lX3NpemUKICAgICAgICByZXF1aXJl\
ZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IDVHaQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAg\
IHRpdGxlOiBOZXh1cyBWb2x1bWUgU2l6ZQogICAgICAgIGRpc3BsYXlfZ3JvdXA6IHByb2plY3QK\
ICAgICAgLSBuYW1lOiBuZXh1c19tZW1vcnlfcmVxdWVzdAogICAgICAgIHJlcXVpcmVkOiB0cnVl\
CiAgICAgICAgZGVmYXVsdDogMUdpCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6\
IE5leHVzIE1lbW9yeSBSZXF1ZXN0CiAgICAgICAgZGlzcGxheV9ncm91cDogcHJvamVjdAogICAg\
ICAtIG5hbWU6IG5leHVzX21lbW9yeV9saW1pdAogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAg\
ICAgZGVmYXVsdDogMkdpCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IE5leHVz\
IE1lbW9yeSBMaW1pdAogICAgICAgIGRpc3BsYXlfZ3JvdXA6IHByb2plY3QKICAgICAgLSBuYW1l\
OiBuZXh1c19jcHVfcmVxdWVzdAogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVs\
dDogNTAwbQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBOZXh1cyBDUFUgUmVx\
dWVzdAogICAgICAgIGRpc3BsYXlfZ3JvdXA6IHByb2plY3QKICAgICAgLSBuYW1lOiBuZXh1c19j\
cHVfbGltaXQKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IDIKICAgICAg\
ICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogTmV4dXMgQ1BVIExpbWl0CiAgICAgICAgZGlz\
cGxheV9ncm91cDogcHJvamVjdAogICAgICAtIG5hbWU6IG5leHVzX3NzbAogICAgICAgIHJlcXVp\
cmVkOiBmYWxzZQogICAgICAgIGRlZmF1bHQ6IFRydWUKICAgICAgICB0eXBlOiBzdHJpbmcKICAg\
ICAgICB0aXRsZTogTmV4dXMgU1NMIEVuYWJsZWQKICAgICAgICBkaXNwbGF5X2dyb3VwOiBuZXh1\
cwogICAgICAtIG5hbWU6IG5leHVzX2FkbWluX3Bhc3N3b3JkCiAgICAgICAgcmVxdWlyZWQ6IHRy\
dWUKICAgICAgICBkZWZhdWx0OiBwYXNzdzByZAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAg\
IHRpdGxlOiBOZXh1cyBBZG1pbiBQYXNzd29yZAogICAgICAgIGRpc3BsYXlfZ3JvdXA6IG5leHVz\
CiAgICAgIAo="


#roles are parsed from /opt/apb/actions/roles:/etc/ansible/roles:/opt/ansible/roles:/opt/apb/actions
COPY roles /opt/ansible/roles
COPY playbooks /opt/apb/actions
COPY . /opt/ansible/roles/nxp-nexus-apb
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
