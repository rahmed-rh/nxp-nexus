FROM registry.redhat.io/openshift3/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogJzEuMC4wJwpuYW1lOiBueHAtbmV4dXMtYXBiCmRlc2NyaXB0aW9uOiBUaGlzIEFQ\
QiBkZXBsb3lzIE5leHVzIGFjY29yZGluZyB0byBOWFAgc3RhbmRhcmRzIGFuZCBkZWZhdWx0IGNv\
bmZpZ3VyYXRpb25zLgpiaW5kYWJsZTogRmFsc2UKbWV0YWRhdGE6CiAgZG9jdW1lbnRhdGlvblVy\
bDogPGxpbmtfdG9fZG9jdW1lbnRhdGlvbj4KICBpbWFnZVVybDogaHR0cHM6Ly9ueHAuY29tL2Fz\
c2V0cy9pbWFnZXMvZW4vbG9nb3MtaW50ZXJuYWwvTlhQX2xvZ28ucG5nCiAgZGVwZW5kZW5jaWVz\
OiBbJ3JlZ2lzdHJ5LmNvbm5lY3QucmVkaGF0LmNvbS9zb25hdHlwZS9uZXh1cy1yZXBvc2l0b3J5\
LW1hbmFnZXInXQogIGRpc3BsYXlOYW1lOiBOWFAgTmV4dXMgRW52aXJvbm1lbnQgCiAgbG9uZ0Rl\
c2NyaXB0aW9uOiBUaGlzIHdpbGwgaW5zdGFsbCBhbiBOWFAgTmV4dXMgc3VwcG9ydGVkIGRlcGxv\
eW1lbnQgYWNjb3JkaW5nIHRvIE5YUCBzdGFuZGFyZCBjb25maWd1cmF0aW9uIGFuZCB2ZXJzaW9u\
cy4gUGxlYXNlIHJlZmVyIHRvIGl0QG54cCBmb3IgYW55IGluZm9ybWF0aW9uCiAgcHJvdmlkZXJE\
aXNwbGF5TmFtZTogIlJlZCBIYXQgQ29uc3VsdGluZyIKcGxhbnM6CiAgLSBuYW1lOiBkZWZhdWx0\
CiAgICBkZXNjcmlwdGlvbjogQSBzaG9ydCBkZXNjcmlwdGlvbiBvZiB3aGF0IHRoaXMgcGxhbiBk\
b2VzCiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5hbWU6IERlZmF1\
bHQKICAgICAgbG9uZ0Rlc2NyaXB0aW9uOiBBIGxvbmdlciBkZXNjcmlwdGlvbiBvZiB3aGF0IHRo\
aXMgcGxhbiBkZXBsb3lzCiAgICAgIGNvc3Q6ICQwLjAwCiAgICBwYXJhbWV0ZXJzOgogICAgICAt\
IG5hbWU6IG5leHVzX3NlcnZpY2VfYWNjb3VudAogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAg\
ICAgZGVmYXVsdDogbmV4dXMKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogTmV4\
dXMgU2VydmljZSBBY2NvdW50CiAgICAgICAgZGlzcGxheV9ncm91cDogcHJvamVjdAogICAgICAt\
IG5hbWU6IG5leHVzX3ZvbHVtZV9zaXplCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBk\
ZWZhdWx0OiA1R2kKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogTmV4dXMgVm9s\
dW1lIFNpemUKICAgICAgICBkaXNwbGF5X2dyb3VwOiBwcm9qZWN0CiAgICAgIC0gbmFtZTogbmV4\
dXNfbWVtb3J5X3JlcXVlc3QKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6\
IDFHaQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBOZXh1cyBNZW1vcnkgUmVx\
dWVzdAogICAgICAgIGRpc3BsYXlfZ3JvdXA6IHByb2plY3QKICAgICAgLSBuYW1lOiBuZXh1c19t\
ZW1vcnlfbGltaXQKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IDJHaQog\
ICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBOZXh1cyBNZW1vcnkgTGltaXQKICAg\
ICAgICBkaXNwbGF5X2dyb3VwOiBwcm9qZWN0CiAgICAgIC0gbmFtZTogbmV4dXNfY3B1X3JlcXVl\
c3QKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IDUwMG0KICAgICAgICB0\
eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogTmV4dXMgQ1BVIFJlcXVlc3QKICAgICAgICBkaXNw\
bGF5X2dyb3VwOiBwcm9qZWN0CiAgICAgIC0gbmFtZTogbmV4dXNfY3B1X2xpbWl0CiAgICAgICAg\
cmVxdWlyZWQ6IHRydWUKICAgICAgICBkZWZhdWx0OiAyCiAgICAgICAgdHlwZTogc3RyaW5nCiAg\
ICAgICAgdGl0bGU6IE5leHVzIENQVSBMaW1pdAogICAgICAgIGRpc3BsYXlfZ3JvdXA6IHByb2pl\
Y3QKICAgICAgLSBuYW1lOiBuZXh1c19zc2wKICAgICAgICByZXF1aXJlZDogZmFsc2UKICAgICAg\
ICBkZWZhdWx0OiBUcnVlCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IE5leHVz\
IFNTTCBFbmFibGVkCiAgICAgICAgZGlzcGxheV9ncm91cDogbmV4dXMKICAgICAgLSBuYW1lOiBu\
ZXh1c19hZG1pbl9wYXNzd29yZAogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVs\
dDogcGFzc3cwcmQKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogTmV4dXMgQWRt\
aW4gUGFzc3dvcmQKICAgICAgICBkaXNwbGF5X2dyb3VwOiBuZXh1cwogICAgICAK"


#roles are parsed from /opt/apb/actions/roles:/etc/ansible/roles:/opt/ansible/roles:/opt/apb/actions
COPY roles /opt/ansible/roles
COPY playbooks /opt/apb/actions
COPY . /opt/ansible/roles/nxp-nexus-apb
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
