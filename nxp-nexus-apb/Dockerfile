FROM registry.redhat.io/openshift3/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogJzEuMC4wJwpuYW1lOiBueHAtbmV4dXMtYXBiCmRlc2NyaXB0aW9uOiBBIHNob3J0\
IGRlc2NyaXB0aW9uIG9mIHdoYXQgdGhpcyBBUEIgZG9lcwpiaW5kYWJsZTogRmFsc2UKYXN5bmM6\
IHVuc3VwcG9ydGVkIAptZXRhZGF0YToKICBkb2N1bWVudGF0aW9uVXJsOiA8bGlua190b19kb2N1\
bWVudGF0aW9uPgogIGltYWdlVXJsOiBodHRwczovL3N0YXRpYy5yZWRoYXQuY29tL2xpYnMvcmVk\
aGF0L2JyYW5kLWFzc2V0cy9sYXRlc3QvY29ycC9sb2dvLnBuZwogIGRlcGVuZGVuY2llczogWyc8\
cmVnaXN0cnk+Lzxvcmdhbml6YXRpb24+LzxkZXBlbmRlbmN5X25hbWVfMT4nLCAnPHJlZ2lzdHJ5\
Pi88b3JnYW5pemF0aW9uPi88ZGVwZW5kZW5jeV9uYW1lXzI+J10KICBkaXNwbGF5TmFtZTogTlhQ\
IE5leHVzIEFwcCAoQVBCKQogIGxvbmdEZXNjcmlwdGlvbjogTlhQIE5leHVzIChBUEIpCiAgcHJv\
dmlkZXJEaXNwbGF5TmFtZTogIlJlZCBIYXQsIEluYy4iCnBsYW5zOgogIC0gbmFtZTogZGVmYXVs\
dAogICAgZGVzY3JpcHRpb246IEEgc2hvcnQgZGVzY3JpcHRpb24gb2Ygd2hhdCB0aGlzIHBsYW4g\
ZG9lcwogICAgZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1lOiBEZWZh\
dWx0CiAgICAgIGxvbmdEZXNjcmlwdGlvbjogQSBsb25nZXIgZGVzY3JpcHRpb24gb2Ygd2hhdCB0\
aGlzIHBsYW4gZGVwbG95cwogICAgICBjb3N0OiAkMC4wMAogICAgcGFyYW1ldGVyczoKICAgICAg\
LSBuYW1lOiBuZXh1c19zZXJ2aWNlX2FjY291bnQKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAg\
ICAgIGRlZmF1bHQ6IG5leHVzCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IE5l\
eHVzIFNlcnZpY2UgQWNjb3VudAogICAgICAgIGRpc3BsYXlfZ3JvdXA6IHByb2plY3QKICAgICAg\
LSBuYW1lOiBuZXh1c192b2x1bWVfc2l6ZQogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAg\
ZGVmYXVsdDogNUdpCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IE5leHVzIFZv\
bHVtZSBTaXplCiAgICAgICAgZGlzcGxheV9ncm91cDogcHJvamVjdAogICAgICAtIG5hbWU6IG5l\
eHVzX21lbW9yeV9yZXF1ZXN0CiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkZWZhdWx0\
OiAxR2kKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogTmV4dXMgTWVtb3J5IFJl\
cXVlc3QKICAgICAgICBkaXNwbGF5X2dyb3VwOiBwcm9qZWN0CiAgICAgIC0gbmFtZTogbmV4dXNf\
bWVtb3J5X2xpbWl0CiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkZWZhdWx0OiAyR2kK\
ICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogTmV4dXMgTWVtb3J5IExpbWl0CiAg\
ICAgICAgZGlzcGxheV9ncm91cDogcHJvamVjdAogICAgICAtIG5hbWU6IG5leHVzX2NwdV9yZXF1\
ZXN0CiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkZWZhdWx0OiA1MDBtCiAgICAgICAg\
dHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IE5leHVzIENQVSBSZXF1ZXN0CiAgICAgICAgZGlz\
cGxheV9ncm91cDogcHJvamVjdAogICAgICAtIG5hbWU6IG5leHVzX2NwdV9saW1pdAogICAgICAg\
IHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogMgogICAgICAgIHR5cGU6IHN0cmluZwog\
ICAgICAgIHRpdGxlOiBOZXh1cyBDUFUgTGltaXQKICAgICAgICBkaXNwbGF5X2dyb3VwOiBwcm9q\
ZWN0CiAgICAgIC0gbmFtZTogbmV4dXNfc3NsCiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlCiAgICAg\
ICAgZGVmYXVsdDogVHJ1ZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBOZXh1\
cyBTU0wgRW5hYmxlZAogICAgICAgIGRpc3BsYXlfZ3JvdXA6IG5leHVzCiAgICAgIC0gbmFtZTog\
bmV4dXNfYWRtaW5fcGFzc3dvcmQKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1\
bHQ6IHBhc3N3MHJkCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IE5leHVzIEFk\
bWluIFBhc3N3b3JkCiAgICAgICAgZGlzcGxheV9ncm91cDogbmV4dXMKICAgICAgCg=="


#roles are parsed from /opt/apb/actions/roles:/etc/ansible/roles:/opt/ansible/roles:/opt/apb/actions
COPY roles /opt/ansible/roles
COPY playbooks /opt/apb/actions
COPY . /opt/ansible/roles/nxp-nexus-apb
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
