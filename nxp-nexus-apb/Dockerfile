FROM registry.redhat.io/openshift3/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogJzEuMC4wJwpuYW1lOiBueHAtbmV4dXMtYXBiCmRlc2NyaXB0aW9uOiBUaGlzIEFQ\
QiBkZXBsb3lzIE5leHVzIGFjY29yZGluZyB0byBOWFAgc3RhbmRhcmRzIGFuZCBkZWZhdWx0IGNv\
bmZpZ3VyYXRpb25zLgpiaW5kYWJsZTogRmFsc2UKYXN5bmM6IHVuc3VwcG9ydGVkIAptZXRhZGF0\
YToKICBkb2N1bWVudGF0aW9uVXJsOiA8bGlua190b19kb2N1bWVudGF0aW9uPgogIGltYWdlVXJs\
OiBodHRwczovL254cC5jb20vYXNzZXRzL2ltYWdlcy9lbi9sb2dvcy1pbnRlcm5hbC9OWFBfbG9n\
by5wbmcKICBkZXBlbmRlbmNpZXM6IFsncmVnaXN0cnkuY29ubmVjdC5yZWRoYXQuY29tL3NvbmF0\
eXBlL25leHVzLXJlcG9zaXRvcnktbWFuYWdlciddCiAgZGlzcGxheU5hbWU6IE5YUCBOZXh1cyBF\
bnZpcm9ubWVudCAKICBsb25nRGVzY3JpcHRpb246IFRoaXMgd2lsbCBpbnN0YWxsIGFuIE5YUCBO\
ZXh1cyBzdXBwb3J0ZWQgZGVwbG95bWVudCBhY2NvcmRpbmcgdG8gTlhQIHN0YW5kYXJkIGNvbmZp\
Z3VyYXRpb24gYW5kIHZlcnNpb25zLiBQbGVhc2UgcmVmZXIgdG8gaXRAbnhwIGZvciBhbnkgaW5m\
b3JtYXRpb24KICBwcm92aWRlckRpc3BsYXlOYW1lOiAiUmVkIEhhdCBDb25zdWx0aW5nIgpwbGFu\
czoKICAtIG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBBIHNob3J0IGRlc2NyaXB0aW9u\
IG9mIHdoYXQgdGhpcyBwbGFuIGRvZXMKICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOgogICAg\
ICBkaXNwbGF5TmFtZTogRGVmYXVsdAogICAgICBsb25nRGVzY3JpcHRpb246IEEgbG9uZ2VyIGRl\
c2NyaXB0aW9uIG9mIHdoYXQgdGhpcyBwbGFuIGRlcGxveXMKICAgICAgY29zdDogJDAuMDAKICAg\
IHBhcmFtZXRlcnM6CiAgICAgIC0gbmFtZTogbmV4dXNfc2VydmljZV9hY2NvdW50CiAgICAgICAg\
cmVxdWlyZWQ6IHRydWUKICAgICAgICBkZWZhdWx0OiBuZXh1cwogICAgICAgIHR5cGU6IHN0cmlu\
ZwogICAgICAgIHRpdGxlOiBOZXh1cyBTZXJ2aWNlIEFjY291bnQKICAgICAgICBkaXNwbGF5X2dy\
b3VwOiBwcm9qZWN0CiAgICAgIC0gbmFtZTogbmV4dXNfdm9sdW1lX3NpemUKICAgICAgICByZXF1\
aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IDVHaQogICAgICAgIHR5cGU6IHN0cmluZwogICAg\
ICAgIHRpdGxlOiBOZXh1cyBWb2x1bWUgU2l6ZQogICAgICAgIGRpc3BsYXlfZ3JvdXA6IHByb2pl\
Y3QKICAgICAgLSBuYW1lOiBuZXh1c19tZW1vcnlfcmVxdWVzdAogICAgICAgIHJlcXVpcmVkOiB0\
cnVlCiAgICAgICAgZGVmYXVsdDogMUdpCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0\
bGU6IE5leHVzIE1lbW9yeSBSZXF1ZXN0CiAgICAgICAgZGlzcGxheV9ncm91cDogcHJvamVjdAog\
ICAgICAtIG5hbWU6IG5leHVzX21lbW9yeV9saW1pdAogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAg\
ICAgICAgZGVmYXVsdDogMkdpCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IE5l\
eHVzIE1lbW9yeSBMaW1pdAogICAgICAgIGRpc3BsYXlfZ3JvdXA6IHByb2plY3QKICAgICAgLSBu\
YW1lOiBuZXh1c19jcHVfcmVxdWVzdAogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVm\
YXVsdDogNTAwbQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBOZXh1cyBDUFUg\
UmVxdWVzdAogICAgICAgIGRpc3BsYXlfZ3JvdXA6IHByb2plY3QKICAgICAgLSBuYW1lOiBuZXh1\
c19jcHVfbGltaXQKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IDIKICAg\
ICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogTmV4dXMgQ1BVIExpbWl0CiAgICAgICAg\
ZGlzcGxheV9ncm91cDogcHJvamVjdAogICAgICAtIG5hbWU6IG5leHVzX3NzbAogICAgICAgIHJl\
cXVpcmVkOiBmYWxzZQogICAgICAgIGRlZmF1bHQ6IFRydWUKICAgICAgICB0eXBlOiBzdHJpbmcK\
ICAgICAgICB0aXRsZTogTmV4dXMgU1NMIEVuYWJsZWQKICAgICAgICBkaXNwbGF5X2dyb3VwOiBu\
ZXh1cwogICAgICAtIG5hbWU6IG5leHVzX2FkbWluX3Bhc3N3b3JkCiAgICAgICAgcmVxdWlyZWQ6\
IHRydWUKICAgICAgICBkZWZhdWx0OiBwYXNzdzByZAogICAgICAgIHR5cGU6IHN0cmluZwogICAg\
ICAgIHRpdGxlOiBOZXh1cyBBZG1pbiBQYXNzd29yZAogICAgICAgIGRpc3BsYXlfZ3JvdXA6IG5l\
eHVzCiAgICAgIAo="


#roles are parsed from /opt/apb/actions/roles:/etc/ansible/roles:/opt/ansible/roles:/opt/apb/actions
COPY roles /opt/ansible/roles
COPY playbooks /opt/apb/actions
COPY . /opt/ansible/roles/nxp-nexus-apb
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
